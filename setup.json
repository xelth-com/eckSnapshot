{
  "_comment": "Central configuration file for eck-snapshot. ALL settings are configured here.",
  "projectContext": {
    "name": "eckasse",
    "type": "monorepo",
    "architecture": {
      "workspaces": [
        "@eckasse/core",
        "@eckasse/desktop",
        "@eckasse/adapters",
        "@eckasse/shared-frontend"
      ],
      "stack": [
        "Node.js",
        "Express",
        "Electron",
        "PostgreSQL",
        "WebSocket"
      ],
      "aiIntegration": "Google Gemini for POS natural language control"
    }
  },
  "projectDetection": {
    "_comment": "Automatic project type detection based on file structure",
    "patterns": {
      "android": {
        "files": [
          "build.gradle",
          "build.gradle.kts",
          "settings.gradle",
          "settings.gradle.kts"
        ],
        "directories": [
          "app/src/main",
          "app/src/androidTest"
        ],
        "manifestFiles": [
          "AndroidManifest.xml"
        ],
        "priority": 10
      },
      "nodejs-monorepo": {
        "files": [
          "package.json"
        ],
        "directories": [
          "packages",
          "apps",
          "libs"
        ],
        "patterns": [
          "workspaces",
          "lerna",
          "nx",
          "rush"
        ],
        "priority": 7
      },
      "nodejs": {
        "files": [
          "package.json"
        ],
        "directories": [
          "node_modules"
        ],
        "priority": 6
      },
      "python-poetry": {
        "files": [
          "pyproject.toml"
        ],
        "patterns": [
          "tool.poetry"
        ],
        "priority": 9
      },
      "python-pip": {
        "files": [
          "requirements.txt",
          "setup.py",
          "setup.cfg"
        ],
        "directories": [
          "__pycache__",
          "venv",
          ".venv"
        ],
        "priority": 7
      },
      "python-conda": {
        "files": [
          "environment.yml",
          "environment.yaml",
          "conda.yml"
        ],
        "priority": 8
      },
      "django": {
        "files": [
          "manage.py"
        ],
        "patterns": [
          "django",
          "Django"
        ],
        "priority": 9
      },
      "flask": {
        "files": [
          "app.py",
          "application.py"
        ],
        "patterns": [
          "flask",
          "Flask"
        ],
        "priority": 8
      },
      "flutter": {
        "files": [
          "pubspec.yaml"
        ],
        "directories": [
          "lib",
          "android",
          "ios"
        ],
        "priority": 8
      },
      "react-native": {
        "files": [
          "package.json"
        ],
        "directories": [
          "android",
          "ios"
        ],
        "patterns": [
          "react-native"
        ],
        "priority": 8
      },
      "rust": {
        "files": [
          "Cargo.toml"
        ],
        "directories": [
          "src",
          "target"
        ],
        "priority": 9
      },
      "go": {
        "files": [
          "go.mod",
          "go.sum"
        ],
        "directories": [
          "cmd",
          "pkg",
          "internal"
        ],
        "priority": 7
      },
      "dotnet": {
        "files": [
          "*.csproj",
          "*.sln",
          "*.fsproj",
          "*.vbproj"
        ],
        "directories": [
          "bin",
          "obj"
        ],
        "priority": 7
      },
      "c": {
        "files": [
          "Makefile",
          "CMakeLists.txt",
          "*.c",
          "*.h"
        ],
        "directories": [
          "src",
          "include",
          "lib"
        ],
        "priority": 6
      }
    }
  },
  "environmentDetection": {
    "_comment": "Cross-platform environment detection",
    "scanCommand": "node -e \"console.log(['ENV', process.platform+'/'+require('os').arch(), process.version, require('fs').existsSync('*.sqlite*')?'SQLite':'none', require('path').basename(process.cwd())].join('|'))\"",
    "responseFormat": "ENV|OS/arch|NodeVersion|Database|ProjectFolder",
    "platformMarkers": {
      "development": {
        "paths": [
          "/home/",
          "/Users/",
          "\\Users\\",
          "WSL"
        ],
        "database": [
          "SQLite",
          "*.sqlite*"
        ],
        "process": [
          "npm",
          "node"
        ]
      },
      "production": {
        "paths": [
          "/var/www/",
          "/opt/",
          "/srv/"
        ],
        "database": [
          "PostgreSQL",
          "eckwms"
        ],
        "process": [
          "PM2",
          "systemd"
        ]
      }
    }
  },
  "contextProfiles": {
    "backend": {
      "description": "Backend API, services, business logic",
      "include": [
        "packages/backend/**",
        "packages/core/**"
      ],
      "exclude": [
        "**/*.test.*",
        "node_modules/**"
      ]
    },
    "frontend": {
      "description": "Electron app and frontend components",
      "include": [
        "packages/desktop/**",
        "packages/shared-frontend/**",
        "packages/adapters/**"
      ],
      "exclude": [
        "**/dist/**",
        "**/build/**",
        "**/node_modules/**"
      ]
    },
    "android-core": {
      "description": "Android app source code and resources",
      "include": [
        "app/src/main/java/**",
        "app/src/main/kotlin/**",
        "app/src/main/res/**",
        "app/src/main/AndroidManifest.xml",
        "build.gradle*",
        "settings.gradle*"
      ],
      "exclude": [
        "**/build/**",
        "**/.gradle/**",
        "**/generated/**",
        "app/src/androidTest/**",
        "app/src/test/**"
      ]
    },
    "android-tests": {
      "description": "Android test code and configurations",
      "include": [
        "app/src/test/**",
        "app/src/androidTest/**",
        "**/test/**"
      ],
      "exclude": [
        "**/build/**"
      ]
    },
    "android-config": {
      "description": "Android build configuration and dependencies",
      "include": [
        "build.gradle*",
        "settings.gradle*",
        "gradle.properties",
        "local.properties",
        "proguard-rules.pro",
        "gradle/libs.versions.toml"
      ]
    },
    "database": {
      "description": "Database schema and migrations only",
      "include": [
        "**/migrations/**",
        "**/schema/**"
      ]
    },
    "deployment": {
      "description": "Deployment and PM2 configuration",
      "include": [
        "ecosystem.config.js",
        "pm2.json",
        ".github/workflows/**"
      ]
    },
    "test-frontend": {
      "description": "Test frontend profile",
      "include": [
        "frontend/**"
      ],
      "exclude": []
    },
    "test-backend": {
      "description": "Test backend profile",
      "include": [
        "backend/**"
      ],
      "exclude": []
    }
  },
  "fileFiltering": {
    "filesToIgnore": [
      "package-lock.json",
      "npm-shrinkwrap.json",
      "yarn.lock",
      "pnpm-lock.yaml",
      "*.log",
      "*.tmp",
      ".env",
      ".env.local",
      ".env.production",
      "eckasse_*.sqlite*",
      "README*",
      "readme*",
      "LICENSE*"
    ],
    "extensionsToIgnore": [
      ".sql",
      ".sqlite3",
      ".sqlite",
      ".db",
      ".DS_Store",
      ".env",
      ".pyc",
      ".class",
      ".jar",
      ".aar",
      ".apk",
      ".aab",
      ".dex",
      ".o",
      ".so",
      ".dylib",
      ".log",
      ".tmp",
      ".bak",
      ".swp",
      ".ico",
      ".png",
      ".jpg",
      ".jpeg",
      ".gif",
      ".svg"
    ],
    "dirsToIgnore": [
      "node_modules/",
      ".git/",
      "dist/",
      "build/",
      ".next/",
      ".nuxt/",
      "target/",
      "bin/",
      "obj/",
      ".idea/",
      "coverage/",
      "create-snapshot/"
    ],
    "includeHidden": false,
    "eckDirectoryFiltering": {
      "_comment": "Smart filtering for .eck directory - includes documentation but excludes confidential files",
      "enabled": true,
      "confidentialPatterns": [
        "SERVER_ACCESS.md",
        "CREDENTIALS*.md",
        "SECRETS*.md",
        "*.secret",
        "*.key",
        "*.pem",
        ".env*"
      ],
      "alwaysIncludePatterns": []
    },
    "projectSpecific": {
      "android": {
        "filesToIgnore": [
          "gradle-wrapper.jar",
          "local.properties",
          "*.iml",
          "*.apk",
          "*.aab",
          "*.aar",
          "*.jar",
          "*.dex",
          "R.java",
          "BuildConfig.java",
          "gradlew",
          "gradlew.bat",
          "gradle-wrapper.properties",
          "ExampleInstrumentedTest.kt",
          "ExampleUnitTest.kt",
          "ic_launcher*.xml"
        ],
        "dirsToIgnore": [
          "build/",
          ".gradle/",
          ".idea/",
          "app/build/",
          "app/.cxx/",
          "**/generated/",
          "**/intermediates/",
          "**/outputs/",
          "**/tmp/"
        ],
        "extensionsToIgnore": [
          ".apk",
          ".aab",
          ".aar",
          ".jar",
          ".dex",
          ".pro",
          ".ap_",
          ".aidl",
          ".svg"
        ]
      },
      "nodejs": {
        "filesToIgnore": [
          "package-lock.json",
          "yarn.lock",
          "pnpm-lock.yaml"
        ],
        "dirsToIgnore": [
          "node_modules/",
          "dist/",
          ".next/"
        ]
      },
      "python": {
        "filesToIgnore": [
          "*.pyc",
          "*.pyo",
          "*.pyd",
          "__pycache__",
          "*.egg-info",
          ".coverage"
        ],
        "dirsToIgnore": [
          "__pycache__/",
          ".pytest_cache/",
          ".coverage/",
          "venv/",
          ".venv/",
          "env/",
          ".env/",
          "dist/",
          "build/",
          "*.egg-info/",
          ".tox/",
          ".mypy_cache/"
        ],
        "extensionsToIgnore": [
          ".pyc",
          ".pyo",
          ".pyd"
        ]
      },
      "rust": {
        "filesToIgnore": [
          "Cargo.lock"
        ],
        "dirsToIgnore": [
          "target/",
          "debug/",
          "release/"
        ]
      },
      "go": {
        "filesToIgnore": [
          "go.sum"
        ],
        "dirsToIgnore": [
          "vendor/"
        ]
      },
      "dotnet": {
        "filesToIgnore": [
          "*.user",
          "*.suo",
          "*.cache"
        ],
        "dirsToIgnore": [
          "bin/",
          "obj/",
          ".vs/",
          "packages/"
        ]
      },
      "c": {
        "filesToIgnore": [
          "*.o",
          "*.a",
          "*.so",
          "*.out",
          "*.exe"
        ],
        "dirsToIgnore": [
          "build/",
          "cmake-build-debug/",
          "cmake-build-release/",
          ".cmake/"
        ],
        "extensionsToIgnore": [
          ".o",
          ".a",
          ".so",
          ".out"
        ]
      }
    }
  },
  "performance": {
    "maxFileSize": "10MB",
    "maxTotalSize": "100MB",
    "maxDepth": 10,
    "concurrency": 10
  },
  "security": {
    "scanForSecrets": true,
    "_comment": "Automatically detects and redacts API keys, tokens, and credentials in snapshots to prevent accidental exposure"
  },
  "output": {
    "defaultFormat": "md",
    "defaultPath": "./.eck/snapshots",
    "includeTree": true,
    "_comment": "Default output format for snapshots: md, json, or txt. defaultPath is the output directory. includeTree controls whether to include directory structure."
  },
  "aiInstructions": {
    "architectPersona": {
      "role": "Senior Architect (Gemini 3 Pro) & Orchestrator",
      "goal": "Lead the project globally. You see the WHOLE project. Delegate implementation management to Junior Architects (Sonnet 4.5 / Opus 4.5).",
      "contextRequirement": "ALWAYS check environment context before generating commands",
      "workflow": [
        "Request ENV scan",
        "Analyze Request using Global Context (Gemini 3 Pro)",
        "Select the best Junior Architect (JAS for speed, JAO for complexity)",
        "Delegate the task using 'execute_strategic_task'",
        "Review the result"
      ]
    },
    "executionAgents": {
      "local_dev": {
        "active": true,
        "name": "Local Terminal (Sonnet 4.5)",
        "description": "Direct execution interface. Use for quick commands.",
        "guiSupport": true,
        "identification": {
          "markers": ["local_dev"]
        },
        "capabilities": ["npm", "git", "basic editing"],
        "restrictions": ["Do not use for complex architectural tasks"]
      },
      "jas": {
        "active": true,
        "name": "Junior Architect (Sonnet 4.5)",
        "description": "Smart & Fast Manager. Best for standard features and refactoring. Manages GLM Z.AI workers.",
        "guiSupport": true,
        "identification": {
          "markers": ["sonnet", "fast_architect"]
        },
        "capabilities": [
          "glm_zai_frontend",
          "glm_zai_backend",
          "glm_zai_qa",
          "glm_zai_refactor",
          "glm_zai_general",
          "git operations",
          "npm run dev"
        ],
        "restrictions": [
          "Prefer delegating heavy coding to GLM Z.AI workers",
          "Focus on glue code and logic verification"
        ]
      },
      "jao": {
        "active": true,
        "name": "Junior Architect (Opus 4.5)",
        "description": "Deep Thinker & Planner. Expensive. Use for critical architecture, security, and complex logic.",
        "guiSupport": true,
        "identification": {
          "markers": ["opus", "deep_architect"]
        },
        "capabilities": [
          "glm_zai_frontend",
          "glm_zai_backend",
          "glm_zai_qa",
          "glm_zai_refactor",
          "glm_zai_general",
          "analysis"
        ],
        "restrictions": [
          "STRICTLY DELEGATE boilerplate to GLM Z.AI",
          "Verify every line of code generated by workers",
          "Plan before execution"
        ]
      },
      "jag": {
        "active": true,
        "name": "Junior Architect (Gemini 3 Pro)",
        "description": "Massive Context Handler. Use when changes span >50 files or require full repo understanding.",
        "guiSupport": false,
        "identification": {
          "markers": ["gemini_wsl"]
        },
        "capabilities": [
          "read entire repo",
          "delegate to claude"
        ],
        "restrictions": [
          "Experimental environment"
        ]
      },
      "production_server": {
        "active": true,
        "name": "Production Server Agent (AGENT_PROD_SERVER)",
        "description": "Linux production server with PostgreSQL and PM2, with development capabilities",
        "guiSupport": false,
        "identification": {
          "markers": [
            "/var/www/",
            "PostgreSQL",
            "PM2",
            "eckwms"
          ]
        },
        "capabilities": [
          "pm2 restart/reload/stop/start",
          "postgresql queries",
          "knex migrations --env production",
          "systemctl",
          "log analysis",
          "nginx operations",
          "deployment scripts",
          "file editing",
          "npm install",
          "git operations"
        ],
        "restrictions": [
          "no electron",
          "no GUI apps",
          "no direct DB schema changes without migrations",
          "always backup before migrations"
        ]
      },
      "android_wsl_dev": {
        "active": true,
        "name": "Android WSL Development Agent (AGENT_ANDROID_WSL)",
        "description": "Android development in Windows Subsystem for Linux with Gradle and ADB support",
        "guiSupport": false,
        "identification": {
          "markers": [
            "WSL",
            "build.gradle.kts",
            "/mnt/c/Users",
            "app/src/main",
            "AndroidManifest.xml"
          ]
        },
        "capabilities": [
          "./gradlew build",
          "./gradlew assembleDebug",
          "./gradlew assembleRelease",
          "./gradlew clean",
          "./gradlew lint",
          "./gradlew test",
          "adb devices",
          "adb install",
          "adb logcat",
          "adb shell",
          "git operations",
          "file editing",
          "gradle tasks",
          "gradle wrapper operations"
        ],
        "restrictions": [
          "no direct GUI access (Android Studio)",
          "requires /mnt/c/ path for Windows file system access",
          "no Android emulator control (emulator runs on Windows host)",
          "limited USB device access through WSL",
          "no hardware debugging interfaces"
        ]
      },
      "glm_zai_worker": {
        "active": true,
        "name": "GLM Z.AI Worker Fleet (MCP)",
        "description": "Cost-effective worker fleet via GLM-4.7. Accessed via MCP tools (glm_zai_backend, etc).",
        "guiSupport": false,
        "identification": {
          "markers": ["glm_zai", "glm", "zai"]
        },
        "capabilities": [
          "backend engineering",
          "frontend engineering",
          "qa testing",
          "refactoring",
          "general full-stack"
        ],
        "restrictions": [
          "Requires ZAI_API_KEY",
          "No direct executive power"
        ]
      }
    },
    "browserAutomation": {
      "enabled": true,
      "provider": "Claude in Chrome MCP",
      "availableFor": ["local_dev"],
      "usage_protocol": "CRITICAL: Browser tasks MUST be executed directly by the interactive 'local_dev' agent using its internal tools. DO NOT delegate browser tasks via the 'eck-snapshot ask-claude' CLI command, as the subprocess lacks MCP context.",
      "capabilities": {
        "navigation": "Navigate URLs, handle tabs/windows",
        "interaction": "Click, type, scroll, drag-and-drop",
        "inspection": "Read DOM, extract text, verify styles",
        "debugging": "Access console logs, network activity",
        "visual": "Generate screenshots, record GIF"
      },
      "restrictions": [
        "No non-consensual file downloads",
        "No sensitive credentials interaction",
        "MUST NOT use 'eck-snapshot ask-claude' wrapper for these tasks"
      ]
    },
    "delegationStrategy": {
      "currentMode": "balanced",
      "modes": {
        "aggressive": {
          "description": "Maximize token savings. Delegate ALL file reading and coding > 50 lines.",
          "threshold_lines": 50
        },
        "balanced": {
          "description": "Default. Delegate full file refactoring and massive generation. Read small files directly.",
          "threshold_lines": 200
        },
        "precise": {
          "description": "Maximize quality. Use Sonnet 4.5 for logic, GLM Z.AI only for boilerplate/docs.",
          "threshold_lines": 1000
        }
      }
    },
    "header": {
      "defaultEnabled": true,
      "_comment": "Controls whether AI instruction headers are included by default in snapshots"
    },
    "promptTemplates": {
      "envScanRequest": "src/templates/envScanRequest.md",
      "gitWorkflow": "src/templates/gitWorkflow.md",
      "multiAgent": "src/templates/multiAgent.md",
      "agent": "src/templates/agent-prompt.template.md"
    }
  },
  "consilium": {
    "enabled": true,
    "votingMode": "blind-first",
    "autoTrigger": {
      "conditions": [
        "database migration",
        "production deployment",
        "architecture changes",
        "security updates"
      ]
    },
    "phases": {
      "blind": {
        "enabled": true,
        "timeout": "3m"
      },
      "debate": {
        "enabled": true,
        "triggerDivergence": 0.3,
        "rounds": 2
      }
    },
    "defaultMembers": {
      "architect": {
        "active": true,
        "modelName": "Opus 4.5",
        "role": "System Architecture",
        "strengths": [
          "Complex Reasoning",
          "System Design",
          "Critical Decisions"
        ]
      },
      "database_expert": {
        "active": true,
        "modelName": "Claude",
        "role": "Database Specialist",
        "strengths": [
          "Schema design",
          "Query optimization",
          "data integrity"
        ]
      },
      "devops": {
        "active": true,
        "modelName": "Any Available",
        "role": "Deployment & Operations",
        "strengths": [
          "PM2 configuration",
          "environment management",
          "monitoring"
        ]
      }
    },
    "complexityThresholds": {
      "low": [
        "bug fixes",
        "simple features",
        "documentation"
      ],
      "medium": [
        "feature implementation",
        "refactoring",
        "integration"
      ],
      "high": [
        "architecture changes",
        "system redesign",
        "performance optimization",
        "security implementation"
      ]
    },
    "prompts": {
      "requestTemplate": "\n# Consilium Request\n\n## Task Overview\n- **Complexity:** {{complexity}}\n- **Domain:** {{domain}}\n- **Requesting Agent:** {{requestingAgent}}\n- **Environment:** {{envContext}}\n\n## Problem Description\n{{problemDescription}}\n\n## Questions for Consilium\n{{#each questions}}\n- {{this}}\n{{/each}}\n\n## Available Context\n{{contextDescription}}\n\n---\n",
      "responseTemplate": "\n# Consilium Response - {{modelName}}\n\n## Analysis\n{{analysis}}\n\n## Recommendations\n{{recommendations}}\n\n## Implementation Steps\n{{implementationSteps}}\n\n## Risks and Considerations\n{{risks}}\n\n## Success Metrics\n{{successMetrics}}\n\n---\n"
    }
  }
}