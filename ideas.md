# Идеи по интеграции Eck-Snapshot и Claude Code

## Ключевые принципы:

1.  **Использовать нативные функции:** Самый эффективный способ общения с Claude — это использование его встроенных функций, а не попытка применить универсальный подход "один для всех".
2.  **Контекст — король, но целевой контекст — лучше:** Контекстное окно Claude активно управляется и меньше, чем кажется. Поэтому отправка сфокусированной, релевантной информации превосходит отправку массивного, нецелевого потока данных.
3.  **Делегировать, а не диктовать:** Использовать Gemini в качестве "Архитектора" для обдумывания общей картины и делегировать конкретную, четко определенную задачу Claude, "Программисту".

## Постоянный контекст для Claude (`CLAUDE.md`)

Вместо того чтобы подавать весь снэпшот в первоначальный промпт, мы должны использовать файл `CLAUDE.md` в корневом каталоге проекта `eckWms`.

### Рекомендуемое содержимое для `eckWms/CLAUDE.md`:

1.  **Обзор проекта:** Краткое, высокоуровневое описание `eckWms`. Что он делает? Какова его основная цель?
2.  **Ключевая архитектура:** Краткое изложение основных архитектурных паттернов, главных модулей и их взаимодействия.
3.  **Основные зависимости:** Список наиболее важных библиотек и фреймворков с объяснением, почему они используются.
4.  **Соглашения по кодированию:** Любые конкретные руководства по стилю или паттерны, которым должен следовать Claude (например, "Все новые компоненты должны быть функциональными компонентами с использованием React Hooks", "Управление состоянием осуществляется исключительно с помощью Zustand").
5.  **Типичные паттерны модификации:** Руководство по выполнению рутинных задач, аналогичное тому, что было в заголовке AI Instructions (например, "Чтобы добавить новую конечную точку API, необходимо изменить `routes.js`, создать новый контроллер в `controllers/` и добавить сервис в `services/`).

**Важно: этот файл НЕ должен содержать полный снэпшот кода.** Его цель — дать Claude постоянные, высокоуровневые "правила игры" для этого конкретного проекта.

## Контекст по требованию (часть `eck-snapshot`)

Это информация, которая меняется с каждой задачей.

1.  **Мини-снэпшот, сгенерированный из векторов:** Основной источник контекста по требованию. После того как Архитектор (Gemini) поймет задачу, он должен использовать `eck-snapshot query "..."`, чтобы сгенерировать небольшой, целевой снэпшот, содержащий только самые релевантные файлы и функции. Именно этот мини-снэпшот подается в промпт для Claude.

2.  **Динамические импорты в `CLAUDE.md`:** Для более стабильного, но все же зависящего от задачи контекста, мы можем использовать функцию импорта `@`. Если задача всегда требует знания схемы базы данных, мы могли бы иметь снэпшот только схемы и временно добавить `@/path/to/schema_snapshot.md` в `CLAUDE.md` перед началом сессии.

## Пользовательские слэш-команды

Для оптимизации сложных, повторяющихся задач мы должны создать пользовательские слэш-команды в проекте `eckWms`.

### Структура каталогов:
`eckWms/.claude/commands/eck/`

### Примеры команд:

* **/eck:new-component.md**
    * **Описание:** Создает новый компонент React с правильной структурой и файлами.
    * **Промпт:** "Создай новый компонент React с именем `{arg1}`. Он должен быть функциональным компонентом, использовать TailwindCSS для стилей и располагаться в каталоге `src/components/`. Создай как файл `.jsx`, так и соответствующий файл `.css`."

* **/eck:commit-and-push.md**
    * **Описание:** Фиксирует все текущие изменения с конвенциональным сообщением коммита и отправляет их в новую ветку.
    * **Промпт:** "Проанализируй текущие подготовленные изменения из `!git diff --staged`. Создай конвенциональное сообщение коммита, которое точно описывает эти изменения. Затем закоммить изменения и отправь их в новую ветку с именем `feature/{short-description}`."

Применяя этот рабочий процесс, мы приводим наш процесс в соответствие с предполагаемым использованием Claude Code, используя его сильные стороны и нивелируя слабые (например, меньшее контекстное окно). Это приводит к более эффективному и "правильному" способу взаимодействия с инструментом.